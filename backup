import numpy as np
import argparse
import imutils
import glob
import cv2
import elements as el

# Notes: cu Canny se face template matching pe edge-uri, de testat
# de 

cursor_path = 'Assets/cursor.png'
elements_path = 'Assets/elements/'
elements_img_type = 'png'

visualize = False
tm_threshold = 1000000


# Elements load
(elements,elements_id) = el.load_elements(elements_path, elements_img_type)

cursor = cv2.imread(cursor_path)
cursor = cv2.cvtColor(cursor, cv2.COLOR_BGR2GRAY)
# cursor = cv2.Canny(cursor, 50, 200)
(tH, tW) = cursor.shape[:2]

cap = cv2.VideoCapture('Assets/app_rec_1.mov')

if cap.isOpened() == False:
	print("Error opening video stream or file!")

_ , screenshot = cap.read()

elements_coord = el.get_elements_coordinates(elements, elements_id, screenshot)
elements_color_diff = dict()
for id in elements_id:
	coord_image = screenshot[	elements_coord[id][0][1]:elements_coord[id][1][1],
								elements_coord[id][0][0]:elements_coord[id][1][0]	]
	avg1 = cv2.mean(elements[id])[0:3]
	avg2 = cv2.mean(coord_image)[0:3]
	elements_color_diff[id] = el.color_diff(avg1,avg2) 
	print(elements_color_diff[id])

